{% extends 'generic/object_list.html' %}
{% load helpers %}

{% block extra_styles %}
    <style>
        tr a.job_run .btn {
            margin: -4px 10px 0 0;
        }

        tr.disabled {
            color: #7d7f7c;
        }

        tr.disabled a.job_run {
            cursor: not-allowed;
            opacity: 0.65;
        }

        tr.disabled a.job_run .btn {
            cursor: not-allowed;
        }
    </style>
{% endblock %}

{% block buttons %}
    <div class="btn-group">
        <a class="btn btn-secondary set-job_list-display" data-display="tiles" href="" title="Tiles">
            <span class="mdi mdi-view-grid{% if display == "list" %}-outline{% endif %}"></span>
        </a>
        <a class="btn btn-secondary set-job_list-display" data-display="list" href="" title="List">
            <span class="mdi mdi-view-sequential{% if display == "tiles" %}-outline{% endif %}"></span>
        </a>
    </div>

    <button
        aria-expanded="true"
        class="btn btn-secondary"
        data-nb-toggle="collapse-all"
        data-nb-target="#job_accordion .collapse"
        type="button"
        {% if display == "tiles" %}disabled="disabled"{% endif %}
    >
        Collapse All
    </button>
{% endblock %}

{% block javascript %}
    {{ block.super }}
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Set display anchor links without losing other potentially active query params such as applied filters.
            [...document.querySelectorAll('.set-job_list-display')].forEach((button) => {
                const queryParams = new URLSearchParams(window.location.search);
                queryParams.set('display', button.dataset.display);
                button.setAttribute('href', `?${queryParams.toString()}`);
            });
        });
    </script>
{% endblock %}
