Synced in code changes from `develop` branch up through version 1.5.22.
